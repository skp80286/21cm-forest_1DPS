2025-06-04 20:30:22 INFO     Commandline: f21_inference_ps.py --t_int 500 --limitsamplesize 300
2025-06-04 20:30:22 INFO     ####
2025-06-04 20:30:22 INFO     ### Using "mps" device ###
2025-06-04 20:30:22 INFO     ####
2025-06-04 20:30:22 INFO     Loading training data...
2025-06-04 20:30:22 INFO     Loading files with pattern saved_output/train_test_psbs_dump/denoised_500/mixed_f21_unet_ps_dum_train_test_uGMRT_t500.0_20250604091744/ps/F21_noisy_21cmFAST_200Mpc_z6.0_fX*_xHI*_uGMRT_8kHz_t500h_Smin64.2mJy_alphaR-0.44.csv
2025-06-04 20:30:22 INFO     Found 529 files matching pattern
2025-06-04 20:30:24 INFO     Training data shape: X=(15870, 16), y=(15870, 2)
2025-06-04 20:30:24 INFO     Loading test data...
2025-06-04 20:30:24 INFO     Loading files with pattern saved_output/train_test_psbs_dump/denoised_500/mixed_f21_unet_ps_dum_train_test_uGMRT_t500.0_20250604091744/test_ps/F21_noisy_21cmFAST_200Mpc_z6.0_fX*_xHI*_uGMRT_8kHz_t500h_Smin64.2mJy_alphaR-0.44.csv
2025-06-04 20:30:24 INFO     Found 5 files matching pattern
2025-06-04 20:30:24 INFO     Test data shape: X=(50000, 16), y=(50000, 2)
2025-06-04 20:30:24 INFO     Training XGBoost model...
2025-06-04 20:30:24 INFO     Fitted regressor: XGBRegressor(base_score=None, booster=None, callbacks=None,
             colsample_bylevel=None, colsample_bynode=None,
             colsample_bytree=None, device=None, early_stopping_rounds=None,
             enable_categorical=False, eval_metric=None, feature_types=None,
             gamma=None, grow_policy=None, importance_type=None,
             interaction_constraints=None, learning_rate=None, max_bin=None,
             max_cat_threshold=None, max_cat_to_onehot=None,
             max_delta_step=None, max_depth=None, max_leaves=None,
             min_child_weight=None, missing=nan, monotone_constraints=None,
             multi_strategy=None, n_estimators=None, n_jobs=None,
             num_parallel_tree=None, random_state=42, ...)
2025-06-04 20:30:24 INFO     Booster: <xgboost.core.Booster object at 0x132da5070>
2025-06-04 20:30:24 INFO     Feature importance: [0.         0.         0.38673916 0.24762397 0.02938641 0.01661276
 0.01630946 0.10372537 0.0135157  0.05888159 0.0253567  0.01547346
 0.0245179  0.01857106 0.04328645 0.        ]
2025-06-04 20:30:24 INFO     Importance type weight: {'f2': 1437.0, 'f3': 1099.0, 'f4': 997.0, 'f5': 866.0, 'f6': 803.0, 'f7': 798.0, 'f8': 682.0, 'f9': 715.0, 'f10': 543.0, 'f11': 512.0, 'f12': 609.0, 'f13': 539.0, 'f14': 614.0}
2025-06-04 20:30:24 INFO     Importance type gain: {'f2': 23.744644165039062, 'f3': 15.203380584716797, 'f4': 1.8042386770248413, 'f5': 1.0199745893478394, 'f6': 1.0013529062271118, 'f7': 6.368431568145752, 'f8': 0.8298239707946777, 'f9': 3.6151559352874756, 'f10': 1.5568267107009888, 'f11': 0.9500246047973633, 'f12': 1.505326747894287, 'f13': 1.140208125114441, 'f14': 2.6576600074768066}
2025-06-04 20:30:24 INFO     Importance type cover: {'f2': 925.3048095703125, 'f3': 1481.956298828125, 'f4': 1692.9207763671875, 'f5': 1804.8302001953125, 'f6': 1884.1146240234375, 'f7': 1959.030029296875, 'f8': 3160.8828125, 'f9': 2285.033447265625, 'f10': 2161.23388671875, 'f11': 2154.166015625, 'f12': 2170.784912109375, 'f13': 1572.569580078125, 'f14': 2413.047119140625}
2025-06-04 20:30:24 INFO     Importance type total_gain: {'f2': 34121.0546875, 'f3': 16708.515625, 'f4': 1798.825927734375, 'f5': 883.2980346679688, 'f6': 804.08642578125, 'f7': 5082.00830078125, 'f8': 565.93994140625, 'f9': 2584.83642578125, 'f10': 845.3568725585938, 'f11': 486.41259765625, 'f12': 916.7439575195312, 'f13': 614.5722045898438, 'f14': 1631.80322265625}
2025-06-04 20:30:24 INFO     Importance type total_cover: {'f2': 1329663.0, 'f3': 1628670.0, 'f4': 1687842.0, 'f5': 1562983.0, 'f6': 1512944.0, 'f7': 1563306.0, 'f8': 2155722.0, 'f9': 1633799.0, 'f10': 1173550.0, 'f11': 1102933.0, 'f12': 1322008.0, 'f13': 847615.0, 'f14': 1481611.0}
2025-06-04 20:30:24 INFO     Making predictions...
2025-06-04 20:30:24 INFO     
Model Performance:
2025-06-04 20:30:24 INFO     R2 Score: 0.7101
2025-06-04 20:30:24 INFO     MSE: 0.1320
2025-06-04 20:30:24 INFO     RMSE: 0.3633
2025-06-04 20:30:24 INFO     Saved test results to output/f21_inference_ps_train_test_uGMRT_t500.0_20250604203022/test_results.csv
2025-06-04 20:30:26 INFO     
Results saved to output/f21_inference_ps_train_test_uGMRT_t500.0_20250604203022
